<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A showcase of Jackson Lloyd's software projects.">

    <meta name="og:url" content="https://projects.jbrlloyd.dev/">
    <meta name="og:title" content="JBrLloyd's Project Showcase">
    <meta name="og:type" content="website">
    <meta name="og:description" content="A showcase of Jackson Lloyd's software projects.">
    <meta name="og:image" content="https://jbrlloyd.dev/icon.png">

    <title>JBrLloyd's Projects</title>
    <link rel="icon" type="image/png" href="/images/favicon.png">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4" crossorigin="anonymous"></script>
  </head>
  <body class="min-w-screen min-h-screen bg-gray-900">
    <main class="relative mx-10 my-5">
        <div
          id="projects-list"
          class="grid grid-cols-3 gap-4"
        >
        </div>

        <script>
          var borderColours = new Map([
            [0, 'purple-500'],
            [1, 'orange-500'],
            [2, 'indigo-500'],
            [3, 'yellow-400'],
            [4, 'green-500'],
          ]);

          function renderProjectsList(projects) {
            var contentDiv = document.getElementById('projects-list');

            for (var i = 0; i < projects.length; i++) {
              var project = projects[i];
              var borderColour = borderColours.get(i % borderColours.size);
              
              var div = document.createElement('div');

              div.className = "relative h-full";

              div.setHTMLUnsafe(`
                <span class="absolute top-0 left-0 w-full h-full mt-1 ml-1 bg-${borderColour} rounded-lg"></span>
                <div class="relative flex flex-col gap-y-2 h-full p-4 overflow-y-auto bg-white border-2 border-${borderColour} rounded-lg">
                  <h1 class="underline font-semibold text-lg">${project.projectName}</h1>
                  <p>${project.description}</p>
                  <p>
                    ${!project.githubUrl
                        ? ''
                        : `<a
                            href="${project.githubUrl}"
                            target="_blank"
                            class="text-sm text-blue-800 underline"
                          >Github</a>`
                    }
                    ${!project.website
                        ? ''
                        : `<a
                            href="${project.website}"
                            target="_blank"
                            class="text-sm text-blue-800 underline"
                          >Website</a>`
                    }
                  </p>
                  <div class="flex gap-2">
                    ${project.tags
                      .map(tag => `
                        <div
                          class="text-sm text-white bg-[#fc6e60] w-fit px-1 py-1.5 rounded-full"
                        >${tag}</div>`)
                      .join('')}
                  </div>
                </div>
              `);

              contentDiv.appendChild(div);
            }
          }

          function fetchProjects(){
            var xhr = new XMLHttpRequest();

            xhr.open('GET', '/projects.json', true);

            xhr.onload = function() {
              if (xhr.status === 200) {
                var data = JSON.parse(xhr.responseText);
                renderProjectsList(data);
              } else {
                console.error('Request failed with status:', xhr.status);
              }
            };

            xhr.onerror = function() {
              console.error('Network-related error occured.');
            };

            // Timeout 15s
            xhr.timeout = 15_000;
            xhr.ontimeout = function () {
              console.error("The request timed out.");
            };

            xhr.send();
          }

          fetchProjects();
      </script>
    </main>
  </body>
</html>